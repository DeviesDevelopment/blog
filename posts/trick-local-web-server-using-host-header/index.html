<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Trick your local web server using the Host header | Devies blog</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="TLDR: If you need to &ldquo;trick&rdquo; a local web server that you&rsquo;re making requests to a certain domain, but do not want (or have permissions) to modify /etc/hosts - Set the intended domain in the Host request header instead.
We are currently working on a project where we have an nginx instance that is redirecting traffic for many different domains. In our case, the nginx is an ingress controller in a kubernetes cluster, but you might use a similar approach if you&rsquo;re hosting multiple websites on the same webserver."><meta name=generator content="Hugo 0.102.3"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel=stylesheet href=/blog/ananke/css/main.min.9036e8ca4a3287e27ab2eb511a473b75bdc83acf6db11ab67b1704e7b4fdd475.css><link rel="shortcut icon" href=/blog/favicon.ico type=image/x-icon><meta property="og:title" content="Trick your local web server using the Host header"><meta property="og:description" content="TLDR: If you need to &ldquo;trick&rdquo; a local web server that you&rsquo;re making requests to a certain domain, but do not want (or have permissions) to modify /etc/hosts - Set the intended domain in the Host request header instead.
We are currently working on a project where we have an nginx instance that is redirecting traffic for many different domains. In our case, the nginx is an ingress controller in a kubernetes cluster, but you might use a similar approach if you&rsquo;re hosting multiple websites on the same webserver."><meta property="og:type" content="article"><meta property="og:url" content="https://deviesdevelopment.github.io/blog/posts/trick-local-web-server-using-host-header/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-20T14:56:30+02:00"><meta property="article:modified_time" content="2022-05-20T14:56:30+02:00"><meta itemprop=name content="Trick your local web server using the Host header"><meta itemprop=description content="TLDR: If you need to &ldquo;trick&rdquo; a local web server that you&rsquo;re making requests to a certain domain, but do not want (or have permissions) to modify /etc/hosts - Set the intended domain in the Host request header instead.
We are currently working on a project where we have an nginx instance that is redirecting traffic for many different domains. In our case, the nginx is an ingress controller in a kubernetes cluster, but you might use a similar approach if you&rsquo;re hosting multiple websites on the same webserver."><meta itemprop=datePublished content="2022-05-20T14:56:30+02:00"><meta itemprop=dateModified content="2022-05-20T14:56:30+02:00"><meta itemprop=wordCount content="244"><meta itemprop=keywords content="nginx,DNS,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Trick your local web server using the Host header"><meta name=twitter:description content="TLDR: If you need to &ldquo;trick&rdquo; a local web server that you&rsquo;re making requests to a certain domain, but do not want (or have permissions) to modify /etc/hosts - Set the intended domain in the Host request header instead.
We are currently working on a project where we have an nginx instance that is redirecting traffic for many different domains. In our case, the nginx is an ingress controller in a kubernetes cluster, but you might use a similar approach if you&rsquo;re hosting multiple websites on the same webserver."></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/blog/ class="f3 fw2 hover-white no-underline white-90 dib"><img src=/blog/logo.png class="w100 mw5-ns" alt="Devies blog"></a><div class="flex-l items-center"><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Trick your local web server using the Host header</h1><p class=tracked>By <strong>Rickard Andersson</strong></p><time class="f6 mv4 dib tracked" datetime=2022-05-20T14:56:30+02:00>May 20, 2022</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p><strong>TLDR</strong>: If you need to &ldquo;trick&rdquo; a local web server that you&rsquo;re making requests to a certain domain, but do not want (or have permissions) to modify <code>/etc/hosts</code> - Set the intended domain in the <code>Host</code> request header instead.</p><hr><p>We are currently working on a project where we have an nginx instance that is redirecting traffic for many different domains. In our case, the nginx is an ingress controller in a kubernetes cluster, but you might use a similar approach if you&rsquo;re hosting multiple websites on the same webserver.</p><p>During development we often need to make requests to an nginx that runs locally, but have it behave as if a request was made to e.g. <em>my-domain.com</em>. A common approach to accomplish this is to modify the <a href=https://en.wikipedia.org/wiki/Hosts_(file)><code>/etc/hosts</code></a> file so that <em>my-domain.com</em> resolves to <em>localhost</em>. However, this might not always be feasible or possible. If you need to change the domain often, it can be cumbersome to make file changes in between, or perhaps you need to do this on a machine where you don&rsquo;t have permissions to modify the file (e.g. a build agent).</p><p>In cases like this, you can instead set the <code>Host</code> request header to the intended domain. For example, to make a request to <em>localhost</em> but have the web server behave as if the request was made to <em>my-domain.com</em>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl localhost -H Host:my-domain.com
</span></span></code></pre></div><p>For the project I mentioned above we use this approach when running end-to-end tests in our CI pipeline.</p><ul class=pa0><li class=list><a href=/tags/nginx class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">nginx</a></li><li class=list><a href=/tags/dns class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">DNS</a></li></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://deviesdevelopment.github.io/blog>&copy; Devies blog 2022</a><div><div class=ananke-socials></div></div></div></footer></body></html>